webpackJsonp([5],{"7l3N":function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=(a("4yHo"),a("uuhB")),r=l(n),u=(a("du7Z"),a("IidI")),d=l(u),s=a("BO1k"),o=l(s),i=(a("N3Nc"),a("1cZb")),f=l(i),c=a("Dd8w"),m=l(c),p=a("Zx67"),h=l(p),v=a("Zrlr"),y=l(v),g=a("wxAW"),E=l(g),T=a("zwoO"),D=l(T),b=a("Pf15"),k=l(b),Y=(a("mNLB"),a("sRCy")),w=l(Y),M=(a("RWXa"),a("NJOH")),N=l(M),C=(a("onAH"),a("37+n")),S=l(C),H=a("U7vG"),F=l(H),_=a("PJh5"),V=l(_),x=a("F8kA"),I=a("RH2O"),O=a("5iav"),A=a("PwNh"),R=l(A),q=a("aXWP"),P=l(q),W=S.default.Item,Z=(S.default.Item,N.default.Option),B=w.default.RangePicker,L=function(e){function t(){var e,a,l,n;(0,y.default)(this,t);for(var r=arguments.length,u=Array(r),d=0;d<r;d++)u[d]=arguments[d];return a=l=(0,D.default)(this,(e=t.__proto__||(0,h.default)(t)).call.apply(e,[this].concat(u))),l.state={days:0,typId:"1019",staDate:"",staTime:"",oveDate:"",oveTime:"",date:[],remark:"",visible:!1,radioValue:["0"],keys:[0]},l.changeValue=function(e,t){l.setState({radioValue:e,keys:t})},l.changeTime=function(e,t,a,n){var r=[];""!=e&&(r.push((0,V.default)(e+" "+t,"YYYY-MM-DD HH:mm")),""!=a&&(r.push((0,V.default)(a+" "+n,"YYYY-MM-DD HH:mm")),l.onFinish(r))),l.setState({date:r})},l.onChange=function(e,t){console.log("Selected Time: ",e+"      "+e[1]+"            "+t)},l.onFinish=function(e){var t=l.daysDate(e[0],e[1]);(0,l.props.dispatch)((0,O.tripDay)(t))},l.daysDate=function(e,t){var a=new Date(e),n=new Date(t);return(0,m.default)({staDate:a.getFullYear()+l.formatTen(a.getMonth()+1)+l.formatTen(a.getDate()),staTime:l.formatTen(a.getHours())+l.formatTen(a.getMinutes())+"00"},{oveDate:n.getFullYear()+l.formatTen(n.getMonth()+1)+l.formatTen(n.getDate()),oveTime:l.formatTen(n.getHours())+l.formatTen(n.getMinutes())+"00"})},l.handleChange=function(e){"1019"==e?l.setState({visible:!0}):l.setState({visible:!1})},l.formatDate=function(e,t){var a=new Date(e),n=new Date(t);return(0,m.default)({startDate:a.getFullYear()+l.formatTen(a.getMonth()+1)+l.formatTen(a.getDate()),starTime:l.formatTen(a.getHours())+l.formatTen(a.getMinutes())+"00"},{overDate:n.getFullYear()+l.formatTen(n.getMonth()+1)+l.formatTen(n.getDate()),overTime:l.formatTen(n.getHours())+l.formatTen(n.getMinutes())+"00"})},l.getDate=function(e){var t=new Date(e);return t.getFullYear()+"-"+l.formatTen(t.getMonth()+1)+"-"+l.formatTen(t.getDate())},l.formatTen=function(e){return e>9?e+"":"0"+e},l.disabledDateTime=function(){return{disabledSeconds:function(){return l.range(1,60)}}},l.range=function(e,t){for(var a=[],l=e;l<t;l++)a.push(l);return a},n=a,(0,D.default)(l,n)}return(0,k.default)(t,e),(0,E.default)(t,[{key:"componentDidMount",value:function(){var e=this.props;e.history,(0,e.dispatch)((0,O.defaultDays)());var t=this.props.location.query;if(t&&t.record&&t.disposeType){var a=t.record,l=t.disposeType;this.changeTime(a.attendanceDate.format("YYYY-MM-DD"),"on"===l?"09:00":"14:00",(0,V.default)(a.attendanceDate).add(1,"days").format("YYYY-MM-DD"),"")}}},{key:"handleReset",value:function(e){e.preventDefault(),this.props.form.resetFields(),this.setState({days:0,date:[],remark:""})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){if(e)return void f.default.warning("你确定信息填完了吗？再看看哟!");console.log("Received values of form: ",a);var l=[],n=t.state.radioValue,r=t.state.keys;if("1019"==a.typId){var u=0,d=!0,s=!1,i=void 0;try{for(var c,p=(0,o.default)(r);!(d=(c=p.next()).done);d=!0){var h=c.value;l.push({setoutTimeSta:t.getDate(a["setoutTimeSta-"+h]),arriveTimeSta:t.getDate(a["arriveTimeSta-"+h]),voyageType:n[u],voyageTypeName:"0"==n[u]?"单程":"往返",travelType:a["travelType-"+h],travelTypeName:"0"==a["travelType-"+h]?"飞机":"1"==a["travelType-"+h]?"火车":"2"==a["travelType-"+h]?"汽车":"其它",setoutArea:a["setoutArea-"+h],destination:a["destination-"+h]}),u++}}catch(e){s=!0,i=e}finally{try{!d&&p.return&&p.return()}finally{if(s)throw i}}}var v=t.formatDate(a.startDate[0],a.startDate[1]),y=(0,m.default)({typId:a.typId,remark:a.remark,userName:t.props.user.empNm},v,{busiTrips:l}),g=t.props,E=g.dispatch,T=g.history;E((0,O.tripSave)(y,T,t.props.user.empId))})}},{key:"render",value:function(){var e=this.props.user,t=this.props.form,a=t.getFieldDecorator,l=t.getFieldValue,n={labelCol:{xs:{span:4},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:7}}},u=this.state.visible?F.default.createElement(W,(0,m.default)({},n,{label:"出差行程信息："}),F.default.createElement(P.default,{getFieldDecorator:a,getFieldValue:l,changeValue:this.changeValue})):F.default.createElement("span",null),s={initialValue:this.state.date,rules:[{type:"array",required:!0,message:"请选择出差时间!"}]};return F.default.createElement("div",null,F.default.createElement("div",{className:R.default.back},F.default.createElement(d.default,null,F.default.createElement(x.Link,{to:"Trip"},"返回"))),F.default.createElement("div",{className:R.default.data},F.default.createElement(S.default,null,F.default.createElement(W,(0,m.default)({},n,{label:"流程说明："}),F.default.createElement("p",null,"1.申请延时不超过两个工作日。",F.default.createElement("br",null),"2.因公外出指办公途中因公需离开办公地点外出办事，且外出时间短。",F.default.createElement("br",null),"3.出差一般为耗时一天及以上或者离开工作地点所在市的外出。",F.default.createElement("br",null),"4.海外长期出差只适用于常驻国外人员申请。")),F.default.createElement(W,(0,m.default)({},n,{label:"申请人："}),F.default.createElement("span",null,e.empNm)),F.default.createElement(W,(0,m.default)({},n,{label:"出差类型："}),a("typId",{rules:[{required:!0,message:"请选择出差类型!"}]})(F.default.createElement(N.default,{name:"typId",placeholder:"选择出差类型",style:{width:150},onChange:this.handleChange},F.default.createElement(Z,{value:"1019"},"国内出差"),F.default.createElement(Z,{value:"1029"},"因公外出"),F.default.createElement(Z,{value:"1039"},"海外短期出差"),F.default.createElement(Z,{value:"1049"},"海外长期出差")))),F.default.createElement(W,(0,m.default)({},n,{label:"出差时间："}),a("startDate",s)(F.default.createElement(B,{showTime:{defaultValue:[(0,V.default)("09:00:00","HH:mm:ss"),(0,V.default)("18:00:00","HH:mm:ss")]},format:"YYYY-MM-DD HH:mm:ss",placeholder:["开始时间","结束时间"],disabledTime:this.disabledDateTime,onChange:this.onChange,onOk:this.onFinish,style:{width:300}}))),F.default.createElement(W,{labelCol:{xs:{span:4},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:6}},label:"出差事由："},a("remark",{initialValue:this.state.remark,rules:[{required:!0,message:"真的不打算写点什么吗？"}]})(F.default.createElement(r.default,{type:"textarea",placeholder:"出差事由",autosize:{minRows:4,maxRows:9}}))),F.default.createElement(W,(0,m.default)({},n,{label:"天数："}),F.default.createElement("span",{className:R.default.dayColor}," ",this.props.days," "),"天"),u,F.default.createElement(W,{wrapperCol:{xs:{span:24,offset:0},sm:{span:14,offset:3}}},F.default.createElement(d.default,{type:"ghost",onClick:this.handleReset.bind(this)},"重置"),"         ",F.default.createElement(d.default,{type:"primary",onClick:this.handleSubmit.bind(this),loading:this.props.isFetching},"确定")))))}}]),t}(H.Component),G=function(e){var t=e.trip,a=e.user,l=t.isFetching;return{days:t.days,isFetching:l,user:a}};t.default=(0,I.connect)(G)(S.default.create()(L))},Wn6f:function(e,t){e.exports={table:"_3hFup9kw9NvfZjQEY0ARQL",date:"_1TiYctysTne19WaEylsSc",select:"_1CayWYUL0xkJ21LGpUIC9q",input:"_3Vq4aeGkoxpvTb8-cKhVwB"}},aXWP:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=(a("du7Z"),a("IidI")),r=l(n),u=(a("ODt/"),a("vgHw")),d=l(u),s=(a("4yHo"),a("uuhB")),o=l(s),i=(a("mNLB"),a("sRCy")),f=l(i),c=(a("N3Nc"),a("1cZb")),m=l(c),p=a("Zx67"),h=l(p),v=a("Zrlr"),y=l(v),g=a("wxAW"),E=l(g),T=a("zwoO"),D=l(T),b=a("Pf15"),k=l(b),Y=(a("ZYVT"),a("PoSO")),w=l(Y),M=(a("RWXa"),a("NJOH")),N=l(M),C=(a("onAH"),a("37+n")),S=l(C),H=a("U7vG"),F=l(H),_=a("Wn6f"),V=l(_),x=(S.default.Item,N.default.Option,w.default.Group),I=0,O=function(e){function t(){var e,a,l,n;(0,y.default)(this,t);for(var r=arguments.length,u=Array(r),d=0;d<r;d++)u[d]=arguments[d];return a=l=(0,D.default)(this,(e=t.__proto__||(0,h.default)(t)).call.apply(e,[this].concat(u))),l.state={keys:[0],value:["0"]},l.onChange=function(e,t){var a=l.state.value,n=l.state.keys;a.splice(e,1,t.target.value),l.setState({value:a}),l.props.changeValue(a,n)},l.remove=function(e,t){var a=l.state.keys,n=l.state.value;1!==a.length&&(n.splice(t,1),l.setState({keys:a.filter(function(t){return t!==e}),value:n}),l.props.changeValue(n,a.filter(function(t){return t!==e})))},l.add=function(){var e=l.state.keys,t=l.state.value,a=l.props.getFieldValue,n=e.length-1;if(void 0===a("setoutTimeSta-"+e[n])||void 0===a("arriveTimeSta-"+e[n])||void 0===a("setoutArea-"+e[n])||void 0===a("destination-"+e[n]))return void m.default.warning("请先完成上一条行程信息填写！");I++;var r=e.concat(I);t.push("0"),l.setState({keys:r,value:t}),l.props.changeValue(t,r)},n=a,(0,D.default)(l,n)}return(0,k.default)(t,e),(0,E.default)(t,[{key:"render",value:function(){var e=this,t=this.props.getFieldDecorator,a=this.state.keys,l=a.map(function(l,n){return F.default.createElement("tbody",{key:l},F.default.createElement("tr",{key:l},F.default.createElement("td",null,t("setoutTimeSta-"+l,{rules:[{required:!0,message:"请选择出发日期！"}]})(F.default.createElement(f.default,{showTime:!0,format:"YYYY-MM-DD",style:{width:100}}))),F.default.createElement("td",null,t("arriveTimeSta-"+l,{rules:[{required:!0,message:"请选择到达日期！"}]})(F.default.createElement(f.default,{showTime:!0,format:"YYYY-MM-DD",style:{width:100}}))),F.default.createElement("td",null,t("travelType-"+l,{initialValue:"0"})(F.default.createElement(N.default,{style:{width:70}},F.default.createElement("option",{value:"0"},"飞机"),F.default.createElement("option",{value:"1"},"火车"),F.default.createElement("option",{value:"2"},"汽车"),F.default.createElement("option",{value:"3"},"其他")))),F.default.createElement("td",null,F.default.createElement(x,{key:n,value:e.state.value[n],onChange:e.onChange.bind(e,n)},F.default.createElement(w.default,{value:"0"},"单程"),F.default.createElement(w.default,{value:"1"},"往返"))),F.default.createElement("td",null,t("setoutArea-"+l,{rules:[{required:!0,message:"请输入出发地！"}]})(F.default.createElement(o.default,{placeholder:"请输入出发地",style:{width:130}}))),F.default.createElement("td",null,t("destination-"+l,{rules:[{required:!0,message:"请输入目的地！"}]})(F.default.createElement(o.default,{placeholder:"请输入目的地",style:{width:130}}))),F.default.createElement("td",null,F.default.createElement(d.default,{className:"dynamic-delete-button",type:"minus-circle-o",disabled:1===a.length,onClick:function(){return e.remove(l,n)}}))))});return F.default.createElement("table",{className:V.default.table},F.default.createElement("thead",null,F.default.createElement("tr",null,F.default.createElement("td",{className:V.default.date},"出发日期",F.default.createElement("span",{style:{color:"#f99c6b"}}," *")),F.default.createElement("td",{className:V.default.date},"到达日期",F.default.createElement("span",{style:{color:"#f99c6b"}}," *")),F.default.createElement("td",{className:V.default.select},"出行方式"),F.default.createElement("td",{className:V.default.input},"单程/往返"),F.default.createElement("td",{className:V.default.input},"出发地",F.default.createElement("span",{style:{color:"#f99c6b"}}," *")),F.default.createElement("td",{className:V.default.input},"目的地",F.default.createElement("span",{style:{color:"#f99c6b"}}," *")),F.default.createElement("td",null))),l,F.default.createElement("tbody",null,F.default.createElement("tr",null,F.default.createElement("td",{colSpan:"7"},F.default.createElement(r.default,{type:"dashed",onClick:this.add,style:{width:"50%",left:"-70px"}},F.default.createElement(d.default,{type:"plus"})," 增加行程")))))}}]),t}(H.Component);t.default=O}});